CREATE OR REPLACE FORCE VIEW eemrt.stage_view (po_number,stage_export_date,contract_number,vendor_name,vendor_site_code,release_number,quantity_ordered,quantity_cancelled,quantity_received,quantity_billed,net_quantity_ordered,obligation_balance) AS
SELECT DECODE(RELEASE_NUM,'9999',PO_NUMBER,null,PO_NUMBER, PO_NUMBER    ||'/'    ||RELEASE_NUM ) AS PO_NUMBER ,    DCS.STAGE_DATE STAGE_EXPORT_DATE,    DCS.PO_NUMBER CONTRACT_NUMBER,    DCS.VENDOR_NAME,    DCS.VENDOR_SITE_CODE,    DCS.RELEASE_NUM RELEASE_NUMBER,        SUM(DCS.QUANTITY_ORDERED) QUANTITY_ORDERED,    SUM(DCS.QUANTITY_CANCELLED) QUANTITY_CANCELLED,    SUM(DCS.QUANTITY_RECEIVED) QUANTITY_RECEIVED,    SUM(DCS.QUANTITY_BILLED) QUANTITY_BILLED,    SUM(DCS.NET_QTY_ORDERED) NET_QUANTITY_ORDERED,    SUM(DCS.OBLIGATED_BALANCE) OBLIGATION_BALANCE  FROM DELPHI_CONTRACT_STAGE DCS    GROUP BY     DECODE(RELEASE_NUM,'9999',PO_NUMBER, PO_NUMBER    ||'/'    ||RELEASE_NUM ) ,    STAGE_DATE,    DCS.PO_NUMBER,    DCS.VENDOR_NAME,    DCS.VENDOR_SITE_CODE,    DCS.RELEASE_NUM;